cmake_minimum_required(VERSION 3.16)

# ğŸ“Œ Proje bilgisi
project(gstreamer_cpp_library LANGUAGES CXX)

# ğŸ“Œ C++ standardÄ±
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

# (Ä°steÄŸe baÄŸlÄ±) G++ derleyici yolunu elle belirtebilirsin
# set(CMAKE_CXX_COMPILER "C:/msys64/mingw64/bin/g++.exe")

# ğŸ“ Kaynak ve header dosyalarÄ±nÄ± bul
file(GLOB_RECURSE GSTCPP_HEADERS CONFIGURE_DEPENDS "${PROJECT_SOURCE_DIR}/include/*.h")
file(GLOB_RECURSE GSTCPP_SOURCES CONFIGURE_DEPENDS "${PROJECT_SOURCE_DIR}/src/*.cpp")

# ğŸ“¦ KÃ¼tÃ¼phaneyi oluÅŸtur
add_library(gstcpp STATIC ${GSTCPP_SOURCES} ${GSTCPP_HEADERS})
# EÄŸer dinamik (DLL) kÃ¼tÃ¼phane istersen, Ã¼stteki satÄ±rÄ± yorum satÄ±rÄ±na alÄ±p bunu aÃ§:
# add_library(gstcpp SHARED ${GSTCPP_SOURCES} ${GSTCPP_HEADERS})

# ğŸ“Œ Header dosyalarÄ±nÄ±n bulunduÄŸu include klasÃ¶rÃ¼nÃ¼ herkese aÃ§Ä±k yap
target_include_directories(gstcpp PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/include
)

# ğŸ§© GStreamer, GTK, Poppler ve diÄŸer baÄŸÄ±mlÄ±lÄ±klarÄ± ekle
find_package(PkgConfig REQUIRED)

pkg_check_modules(DEPS REQUIRED
    gtk+-3.0
    gstreamer-1.0
    gstreamer-rtsp-server-1.0
    poppler-cpp
)

# ğŸ“ Include ve link ayarlarÄ±nÄ± hedefe baÄŸla
target_include_directories(gstcpp PUBLIC ${DEPS_INCLUDE_DIRS})
target_link_directories(gstcpp PUBLIC ${DEPS_LIBRARY_DIRS})
target_link_libraries(gstcpp PUBLIC ${DEPS_LIBRARIES})

# âš™ï¸ Derleme uyarÄ±larÄ±nÄ± ve hata ayarlarÄ±nÄ± aÃ§
target_compile_options(gstcpp PRIVATE -Wall -Wextra -g)

# ğŸªŸ Windows / MSYS2 iÃ§in tanÄ±mlar
add_definitions(-DUNICODE -D_UNICODE)

# ğŸ“¤ Build Ã§Ä±ktÄ±sÄ±nÄ± belirli bir klasÃ¶re yÃ¶nlendir
set_target_properties(gstcpp PROPERTIES
    ARCHIVE_OUTPUT_DIRECTORY "${PROJECT_SOURCE_DIR}/output"
    LIBRARY_OUTPUT_DIRECTORY "${PROJECT_SOURCE_DIR}/output"
    RUNTIME_OUTPUT_DIRECTORY "${PROJECT_SOURCE_DIR}/output"
)

# ğŸ§¾ Bilgi mesajlarÄ±
message(STATUS "GStreamer include dirs: ${DEPS_INCLUDE_DIRS}")
message(STATUS "GStreamer libs: ${DEPS_LIBRARIES}")
message(STATUS "Output directory: ${PROJECT_SOURCE_DIR}/output")
